#Alto System
####简介
第一个Alto system诞生于1973年，它是第一个整合了所有图形元素的系统，电脑开始有了图形界面了，后来的苹果的图形系统就是借鉴了这个系统。这个系统的设计开始主要是为了研究目的。Alto一开始就设计的相对小，然而功能非常强大，个人的办公电脑，而且有能力有展现图形界面，这样就非常容易分享信息。


####alto system 特点
Alto系统包括
48-64k 16位内存的话（加上校验和可能误差修正）。

一个10M的盘的传输一个字要7微妙， 旋转在25毫秒，寻道8毫秒，和最坏的情况下，寻求 70毫秒。

901线的电视显示器的显示面，几乎是这一页的大小 。它是垂直的，并且被设计为驱动的记忆中的一点，地图 。它以32K的内存和一个平方补显示 地区（825x620）光栅。这些点是约1.4毫升的平方。 可以减少宽度约1毫米，这给825x860 栅格和44.3k的。正方形栅格可以显示8000 5X7字符与下沉或2500美丽的等间距特征。

一个未编码的键盘，允许处理器以准确确定 当每个键被按下或释放，或鼠标或其他定位装置。

处理器执行的指令在1.5左右我们新星/指令， 并可扩展额外的指令适用于解释型语言Lisp，BCPL，MPS等等。

高带宽（10 MHz）通信接口，具体的细节尚未明确规定。

####Alto  software

早期的软件奥拓写于编程语言 BCPL ，后来在梅萨 ， 这是没有得到广泛的PARC外使用，但影响了几个后来的语言，如MODULA 。 奥拓键盘缺少的下划线键，它已经拨到梅萨用于左箭头人物赋值运算符 。 奥拓这款键盘的功能可能已经来源为驼峰的复合式的标识符 。奥拓的另一特点是，它是微码编程的用户。

Alto捧红使用光栅图形模式，所有输出，包括文本和图形。 它还介绍了位块传输操作，或概念BitBLT的 ，作为基本的编程接口来显示。 尽管它的小内存的大小，很多创新的方案是奥拓写的，其中包括：

第一个所见即所得的 文件准备系统 ， 布拉沃和吉普赛 ;
在劳雷尔 电子邮件工具，它的后继者哈迪 ;
在实矢量图形编辑器，主要用于逻辑电路， 印刷电路板 ，及其他技术图表;
该标记 位图编辑器（一种早期画图程序 ）;
第一个所见即所得的 集成电路编辑器基础上， Conway和米德范式;
在第一版本的Smalltalk环境
中间表
一首网络为基础的多人视频游戏 （ 奥拓迷航由基因球 ）。
没有电子表格或数据库的软件。 （第一个电子表格程序， 软件VisiCalc ，并没有出现，直到1979年。）


可选的是，一个固定的字体字符发生器的一个类似于设计 和道格克拉克建立了。这将节省大量的内存，允许 高质量的字符比可以做一个正方形栅格，但增加了 基本无新的能力。它的成本约为500美元。

最重要的是，成本约为lo.5k，可减至9.7k 由一个2.5字节的磁盘的使用。成本大约是平分 磁盘，记忆中，和其他一切。

简介 
在过去的几年里考虑的操作系统以某种方式来是 广泛接受。 根据这种观点，一个操作系统的功能是提供 一种子宫（或者，如果你喜欢，虚拟机）中的用户或她的节目 能够生存和发展，从外面的世界[2,5的严酷现实安全绝缘， 13。 作者之一，事实上，是这样的“封闭”系统[12]的早期倡导者。 它们具有许多吸引人的特征： • 当硬件是太可怕了普通人的眼光来看待，隐蔽是 善良，如果不是必须的。 • 有用和流行设施以均匀的方式可编，名称 结合并实现它们所需的存储分配拒之门外的方式。 • 系统可以保护自己免受用户无需做任何假设 他们做什么（除了那些隐含在虚拟机的定义）。 • 如果所有的底层结构是一个更强大的设备也许可以提供 隐蔽。 1 本文在对操作系统原理第七届ACM研讨会1979年11月提交 并发表在 ACM操作系统回顾 11，5（1979年12月），页98-105。 创建该版本 从一个通过扫描和OCR; 它可能有错误。 2 将被授予许可，提供不收费的全部或此材料的任何部分复制的拷贝不 制作或分发的直接商业优势，ACM版权声明和的标题 出版物及其日期出现，并发出通知，复制是由该协会的许可 美国计算机。 要复制否则，或再版，需要一定的费用和/或特定权限。

一个开放的操作系统的单用户机 2 另一方面，一个很好的协议可以通过将用户之间距离太大丢失 和硬件[4]，特别是如果她需要处理非常规的输入输出 设备。 此外，具有很大的灵活性，给出了通过这些平，全有或全无的风格 系统，它是非常困难的一个用户来扩展或修改系统由于 锐线是在两者之间绘制。 在本文中，我们探索一种不同的，更“开放”的方法：系统认为是 提供各种设施，其中任何一个的用户可能会拒绝接受，修改或扩展。 在许多情况下，一个设施可以成为一个部件外面的其他设施建立： 例如，文件都建立了磁盘页面。 发生这种情况时，我们试图尽可能 使小元件可访问的用户以及路数。 成功 这样的设计依赖于何种程度上，我们可以利用小的灵活性 组件而不破坏较大的。 特别是，我们必须付出很大的 注意系统的鲁棒性，即，恢复从崩溃和耐 误操作。 我们的系统的另一个方面是，在文件系统和通信标准化 在低于任何在操作系统软件的一个级别。 事实上，它是表示 在盘上被标准化在网络上的数据包和文件。 这允许 编写的程序完全不同的语言（BCPL [4]，梅萨[8]，Lisp的[7]和 Smalltalk中[10]; 前者是先，并且是在所描述的软件的主机语言 本文），并执行使用完全不同的指令集（在实施 可写微码），以共享相同的文件系统和远程设施。 在这样做时，他们 不放弃任何存储在写一门外语的操作系统，或任何 在开关周期从一个编程环境和指令集到另一个位置 每次访问磁盘存储或通信。 支付这种灵活性的代价就是在这些表象的任何改变都需要 改变几个部分的代码，由几个写在几种语言，并保持 不同的人; 这个重写的成本是如此之高，这是有效地不可能 做出这样的改变。 因此，这种方法不能被推荐时，处理器速度 和记忆是充足的; 标准化在一个较高的水平，优选在这种情况下。 在我们的 的情况，但是，该政策已经使机器可能许多主要应用 否则将已经完全不可行的。 此外，我们已经发现 这些限制已经引起一些实际问题，尽管事实的范围 该系统的使用已经远远大于最初预期。 当然，在一个多用户系统，必须有强制性保护机制 确保公平和安全的共享硬件资源，这方面的考虑集 限制可达到的开放性。 在这些限制，然而，许多可 做，确实下面讨论的设施可以在受保护的方式，而不提供 任何伟大的变化，虽然本文避免了问题的一个显式分析 围本身到一个单用户系统。 来描述整个系统以这种方式将是一个相当大的工作。 我们将 这里只讨论了磁盘文件系统，做世界交换的方法，以及 在其中系统被构造出包的方式。

一个开放的操作系统的单用户机 3 2.背景 操作系统从本文的实施例被画为一个被写 小型计算机称为奥拓[16]，其中有一个16位处理器，800 ns的64K字 存储器，和一个或两个运动头的磁盘驱动器，其每一个可以存储2.5兆 在一个单一的可移动组件，并且可以在大约一秒钟传送64k字。 本机 和系统也可以支持其他磁盘用约两倍的大小和性能。 该 机器没有虚拟内存的硬件。 处理器执行的指令集 支持BCPL，包括对过程调用和返回的专项说明。 该系统几乎完全写在BCPL，而事实上该语言被认为是 是编程在机器中的标准方法之一。 编译器生成 普通的机器指令，并且不使用运行时支持程序除了一个小 代码体扩展指令集略。 仅一次一个用户被支撑，并且外围 ​​设备比磁盘其它和 终端很少使用。 其结果是，该系统的当前版本仅具有两个 过程，其中一个把键盘输入字符到一个缓冲器，而另一个则 所有有趣的工作。 键盘过程被中断驱动，并且没有临界 段; 因此没有同步原语和不调度比其他 硬件中断系统。 其结果是，系统不控制处理器分配， 而事实上得到控制，只有当一个用户程序调用一些系统设施。 该系统 确实控制存储分配在一定程度上，无论是在主存储器和磁盘上，在 为了使人们有可能为用户的节目共存并相互通话。 因此，该系统可以被合理地视为其中实施的过程的集合 各种可能有用的抽象对象。 有这些之间没有差异显著 系统过程和一组程序，用户可以写来实现自己的 抽象对象。 事实上，该系统代码是可用作为一组独立的 子程序包，各执行的对象之一，并且这些包有 收到了大量的独立使用，其中并不需要所有的服务的应用程序 该系统的，并且不能承受其成本。 有几种类型的抽象对象的：输入输出流，文件，存储区， 物理磁盘。 所有这些对象都以这样的方式，它们可以是值实现 普通的变量; 因为BCPL是一个无类型语言，这意味着每个对象可以是 通过一个16位机字表示。 当然，在许多情况下，这个词将是一个 指针，以更大的东西。 该流从斯托伊和斯特雷奇的OS6系统[15]复制批发，一样都不少 文件系统的各方面。 我们给出一个简要的描述在这里的完整性。 甲流 是，可以产生或消耗物品的对象。 项目可任意BCPL对象： 字节，字，向量，其他流等有上定义了一组标准的操作 每一个数据流： 从流中获取的项目; 把一个项目到流（通常只有其中一个定义）;

一个开放的操作系统的单用户机 4 复位，这使该流成一些标准的初始状态（确切含义 操作取决于流）的类型; 测试的输入端; 和其他几个人。 这些操作都是由普通BCPL过程调用调用。 甲流是这样的东西就像一个西穆拉类[6]。 它不同于一类，所述 实现了业务程序不相同的所有流，确实能 从随时更改，即使对于一个特定的数据流。 甲流是由一个记录表示 （实际上是BCPL向量），其最初的几个组件包含提供程序 该流的执行标准操作。 该记录的其余部分保持状态 信息，这可能从不同的流流（如字数，指针缓冲区， 磁盘地址，或任何为宜）。 记录的大小不是固定的，而是 完全由创建该流中的程序确定的。 另外，也可以对记录到包含实现非标准程序 操作（例如，缓冲的大小读取一个磁盘文件的位置，等等）。 另外，任意 过程可以用其上执行某些类型的数据流的这样的操作。 在 这两种情况下的程序接收代表流作为参数的记录， 并且可以存储在该记录任何永久性的状态信息。 当然，该程序 使用非规范操作牺牲兼容性，因为它只会与流工作 对于其中该操作被执行。 该方案提供与多种实现抽象对象使用 整个系统。 每个抽象目的是通过，可以是操作定义 它调用; 每个操作的语义的定义（或多或少严格）。 任何 具体实现的数目是可能的，每个提供一个具体过程为 每个抽象操作。 分层结构可以建立这种方式。 为 例如，要创建的具体类型“的磁盘文件流”流对象的过程需要 作为参数另外两个对象：它实现业务访问的磁盘对象 存储的文件所在的，并且它被用来获取和释放的区域的对象 工作存储的流。 3，网页和文件 系统组织的长期储存（在磁盘上）到 文件中 ，每一个都是一个序列 固定大小的 页面 ; 每一页由单个磁盘扇区表示。 虽然一个文件是 足够你们自己，人们通常希望能够附上一个字符串名称给它，并为 为此目的 ，提供了一种辅助的 目录服务。 由于长期的完整性 存储是极其重要的给用户， 扫 气过程被提供给 重建文件系统无论从那个支离破碎的状态可能已经下降状态 成。 这一过程的管理要求大部分的系统设计。 该 本节的剩余扩展了刚才的轮廓。 3.1页 可用于长期储存的最简单的对象是一个页面。 它包括：

一个开放的操作系统的单用户机 五 地址 -一个字这唯一的指定一个物理磁盘位置（H）; 一个 标签，其中包括： F： 文件识别系统，两个字（A）; 五：一个版本号-一个字（A）; PN：一个页面号-一个字（A）; L： 的长度（在本页面包含数据的字节数） -一个字（A） NL：下一个链路一个字（H）; PL：以前链路一个字（H）; 值 - 256数据字（A）。 这使得一个页面的信息是两种： 绝对 （A）和提示 （H）。 该 页面由绝对完全确定。 的提示，因此，存在仅向 提高执行的效率。 每当一个提示的情况下，则检查 对一些绝对以确认其继续有效。 此外，存在一个恢复 操作的重建从绝对的所有提示。 因此，一个页具有唯一的 绝对名，它是该文件的标识符，版本号和 页号（由（FV，n），其中n是页号和FV 表示是该文件 标识符和版本），它具有一个 提示名称，这是该地址。 全名 （FN）的 一个页面是对（绝对名称，提示名称）。 页面（IV中，n）的链接是 其绝对名称（FV，N-1）和（FV，N + 1），或者NIL 如果页面地址不 这样的页面存在。 是一个页面上的基本操作，以读取和写入数据，并 阅读的链接，给出的全名。 需要注意的是，很容易从一个页面的全名，以去 下一个和前几页的全名。 3.2文件 文件是一组具有绝对名称（FV，0），（FV，1）（FV，N）的页面 。 页的名称 （FV，0）也是文件的名称。 上的文件的基本操作是 创建一个新的空文件; 一个页面添加到文件的结束; 删除从末端一个或多个页面; 删除整个文件。 因此，如果页（FV，n） 的存在，页（FV，i）的存在对所有的i 0到n之间。因此，如果 一个文件中的一个页面的地址是已知的，每一个页面可以由以下的链接找到。 如果 （FV，n）是在文件的最后一页，然后页面（FV，I）对我<n的 L = 512（即，他们是全 数据），并在最后一页为L <512。 该文件的数据字节包含在至n 1页 。页0被称为领袖 页，以及包含该文件比其长度和其数据的其它的所有属性： 创建日期，上次写入和上次读（一）; 所谓领导 者名称 的字符串 ，在第3.5节（A）讨论; 最后一页的页号和磁盘地址（H）; 一个 也许连续的标志（H）。

一个开放的操作系统的单用户机 6 页3.3表示 磁盘上的页的物理表示被称为一个 扇区，并包括三个 部分： 一个 头，其中包含了盘组号码（对每个可拆卸包不同） 和磁盘地址; 一个标签，它包含在3.1节规定的七个词; 一个值，它包含256个数据字。 单个磁盘的操作可以执行读，检查或单独在每个写操作 这些部件，其限制是一次写入时开始，就必须继续通过 其余部门。 支票动作比较数据的磁盘与相应数据 从内存中，字所采取的字，并中止整个操作，如果它们不匹配。 如果 存储器字是0，但是，它被替换为相应的磁盘字，从而使一 检查行动是一个简单的一种模式匹配。 该系统使用这些设施，以使磁盘相当强大的存储介质。 磁盘 页面总是被他们的全名访问。 一个扇区的标签始终检查 在写入，并写上只有三次： 当页面被freed-其全名必须给出，并且检查该标签是 正确的。 然后那些被写入标签和值，以确保任何企图 把该页面作为文件的一部分将失败，标签检查错误。 第一次的页写入之后它一直allocated-支票是该页面 是免费的。 然后该页面的适当的标签被写入。 为了改变文件级的长度的最后一个页面的标签被读取和检查。 然后，它被重写时，可能与L和NL的新值。 此方案的页面被分配或者释放每次花费一盘的革命，但它使 页面不太可能的意外覆写。 任何其他写在标签被选中，在 没有时间成本。 校验操作是从一个读区分，使得后续的写 操作前，什么是写，没有采取额外的革命被中止。 该标签还检查了读，当然。 如果检查成功，可以肯定的是， 提示（地址），用于访问磁盘页面实际上导致由指定的页 全名绝对一部分。 正如我们将在下面看到，也有可能找到一个页面从 单独的绝对名称（虽然不是很有效），并重建所有的提示名称 从绝对名称。 磁盘包含一个称为 磁盘描述一个标准的名称和地址的磁盘文件 。 在 它是： 分配图，位表指示哪些网页是免费的（H）; 的圆盘 状，即，轨道，表面的数目，并根据需要向其他信息 参数化磁盘程序进行磁盘的特定型号（A）;

一个开放的操作系统的单用户机 7 根目录的名称（H）。 需要注意的是分配映射是一个暗示，因为绝对有关哪些网页 可以自由包含在标签。 如果地图说一个网页是免费的，分配器将其标记 当分配它，并且当上述标签检查失败，分配器是忙 再次呼吁获得另一页。 因此，一个页面标注不当，免费地图 结果在一点点额外的一次性磁盘活动。 一个页面标注不当忙碌决不会 分配; 这样丢失的页面是由3.5节中描述的清道夫恢复。 我们的实现的磁盘描述的是从上面的描述中略有不同。 主目录下有一个标准的名称和磁盘地址，并指向磁盘描述 文件。 这个方案的出现是因为在磁盘描述符被添加到文件系统中的数据 结构，当它变得明显的是，盘形必须记录以某种方式。 该 上面给出的说明反映了磁盘描述和之间的逻辑关系 主目录（即，这是我们应该怎么做了吧）。 3.4目录 到目前为止，我们已经构建了一个基于网页的数据存储设施和分配 设施基础上的文件。 不提供分配在网页级别，因为失去的轨道 页是太容易，而这又是因为一个页面，作为固定大小的，不能是一个逻辑 单位存储的。 的文件，在另一方面，可以是任意大小的，因此是合适的 插座，用于数据的集合，该用户观看作为一个单元（只要它不是太 小）。 由于文件是一个逻辑单元，而且，它应该有一个逻辑名称，即一个串 命名，以及其唯一文件标识符，以及名称应在一些被解释 方面，使名称可以独立地，而不必担心冲突的分配。 这是我们熟悉的推理而导致树形结构的目录层次结构 [5]。 我们的系统需要一个稍微不同的策略（以下OS6），因为我们的愿望的 把文件作为自己的权利独立的对象。 我们的看法是任何操作 上的文件可以在没有更多的进行比其全名知识（它是 存在关联姓名的第一页的全名），以及一个单独的机制 与文件。 这是通过一个叫做目录文件 ，它包含了一组对（字符串，充满了做 命名）。 一个文件可能会出现在任何数量的目录。 由于没有什么特别之处 从视图的文件系统的点的目录中，有可能有一个树，或实际上 任意定向目录的图。 我们需要能够识别所有的 为清除程序的目录下面描述，并为此我们保留 文件标识符目录中的文件的子集。 进一步的暗示（在这里，我们分手公司OS6）是它必须能够 从文件本身恢复一些逻辑名，使得该文件可以，如果甚至生存 它的目录条目丢失或炒。 这是在领先名称的目的 领导者页面; 其意义应与它在清除扮演的角色明显。 在片头页面中的信息被认为是绝对的，因为这是一个名称按 该文件可以位于即使所有对于它的目录项被破坏。 目录 项，与此相反，采取较轻，尽管它们并不完全冗余和 因此不能被视为纯提示。 如果一个目录被破坏，我们不会失去任何文件，

一个开放的操作系统的单用户机 8 但是我们确实失去了一些信息，即信息的一组特定的文件是 通过一组特定的名称从该目录中引用。 3.5清除 通过阅读所有的标签在磁盘上，我们可以检查所有的链接都是正确的 （重建任何证明故障），获得全名现有的所有文件，并产生 空闲页面列表。 要做到这一点，我们所要做的就是创建所有未标记的标签列表 免费的，由绝对名称排序。 如果有足够的主存来保存一个表48 每扇区的位，一个合适的选择数据结构允许进行该处理 不需任何辅助存储。 这实际上是因为该机器的标准盘的情况下。 更大的磁盘需要这个名单写在磁盘的一个特殊部分保留。 然后，我们可以读取所有的目录，并确认每个条目指向的页面0 现有的文件，修复了地址，如果有必要，并检测其在别处点条目。 如果任何文件中的目录条目仍下落不明，我们可以为它在一个新条目 邮件目录，使用其领导人的名字。 这是领导者的名字的唯一功能。 这整个过程称为清理，大约需要一分钟的2.5兆字节 磁盘。 当它是完整的，所有的线索都被重新计算，从绝对和任何 不一致的（不完全的文件，空目录项，无名文件等）已 检测。 什么做的不一致的问题已经超出了这个范围 纸。 在清除任何永久性坏页被标记在一个标签 特殊值，以便它们不会被再次使用。 正如我们已经指出，清除并不能完全重建丢失的目录。 这可能是 通过写所有更改目录的杂志上，并采取偶尔完成 快照的所有目录。 通过施加的变化轴颈到快照我们 会回到当前状态。 当然，这是一个标准技术，通过该 任何数据库的完整性可以得到保障。 对于已经提到的原因，我们做 不考虑我们的目录重要的，足以保证该等关注。 如果用户 不同意，他可以随意修改系统提供的程序管理目录， 或者写他自己。 我们还写了一个更详细的清道夫，做一个就地置换的 磁盘上的页面文件，使每个文件的页面中连续的扇区。 此 安排通常会增加与该文件可以通过他连续读取速度 幅度在什么是可能的，如果页面都变成分散的订单。 3.6使用提示 提示的目的是为了提高性能。 例如，如果一个程序具备 全名（FV， 我 ）的文件页和提示的地址，就可以直接访问该页面不 经历一个目录查找，没有向下扫描数据块的链。 如果 这种直接访问失败（即在那一抹地址的页面原来不被（FV，I）），该 程序有几个选项： 它可以具有一个全名的文件的一些其他部分（典型地，前导页） 这是正确的。 然后，它可以从网页跟踪链接，还避免目录

一个开放的操作系统的单用户机 9 抬头。 提示地址也可以保持该文件的每 第k页，以减少 链接数量必须遵循。 如果失败，则可能查找FV目录中，以获得正确的磁盘地址。 如果失败，它可能看起来在一个目录下的文件的字符串名称，以获得新的FV 和磁盘地址。 最后，它可以调用清道夫来重建整个文件系统，所有 目录，然后重试前面的步骤之一。 另外，这样的提示可以扩展以命名的文件系统内的特定字节， 简单地通过扩大全名与页面中的字节位置。 提示机构，也可有利地用于被认为是文件 连续分配。 程序是免费的假设一个文件是连续的和， 知道地址 一 我 页 我 ，来计算网页的J作为一个地址 我 + j 的 - 我 。 标签 检查将阻止任何不正确的数据覆盖，并会告知是否计划 磁盘访问成功。 许多程序使用的辅助文件，他们需要快速访问的集合。 该 编辑，例如，使用两个刮文件，一个日志文件，消息等等。当一个文件 这些程序“安装”，他们创造了他们必要的文件和存储提示 随后将被写入到一个 状态文件 的数据结构 。接着，程序可以启动， 读取状态文件，并访问其所有的辅助文件的最大磁盘速度。 如果提示失败， 例如，因为一个临时文件删除了或移动，程序必须重复安装 阶段。 没关系，其中提示存储，而系统没有努力保持 他们最新的。 它只是确保，当提示出现故障，没有损害的是，与 使用提示程序被通知，以便它可以采取纠正措施。 程序之间的通信4. 大多数操作系统的一个主要目标是促进独立之间的通信 程序，通常用不同的编程语言或环境。 但如何 可以通过通信开放式操作系统，允许程序员提供 拒绝系统的所有设备？ 最保守的解决方案是允许 通信只能通过磁盘文件，因为文件的结构必须被所有被观察 节目。 例如，一个命令扫描程序可能被写入输入的命令字符串 用户在使用标准名称的文件，然后可调用程序，将执行 命令。 普通磁盘文件可以用来以这种方式从一个节目数据传递到 另一回事。 磁盘文件结构还必须作为一个方式来调用任意节目， 那就是，以“传输控制”从一个程序到另一个。 由于开放性 操作系统，被叫和主叫程序可能具有共同很少或没有。 控制这些转移都是通过定义一个约定还原整个实现 从磁盘文件的机器状态; 这使得任意程序采取控制 机器。 描述该机器状态的文件可以被用来实现几个 控制学科。 一个协同程序结构，常用的有：一个程序在其记录

一个开放的操作系统的单用户机 10 国家在一个磁盘文件，然后恢复从第二个文件的机器状态。 原 程序恢复执行时，机器状态从第一个文件恢复。 该程序间的沟通机制，发现很多用途。 实例是： -自举。 硬件引导按钮使机器的状态是 从一个磁盘文件的第一页被保持在磁盘上的一个固定位置恢复。 此 启动文件可以被写入通过接头写入程序和数据文件中，设置 以便它们将构成正在运行的程序时，机器状态从恢复 该文件。 另外，该文件可能已被写入通过保存正在运行的状态 程序，将要在计算机被自举每次恢复。 -调试。 当遇到断点当用户罢工特殊或 DEBUG 键盘上键时，机器的状态被写在磁盘文件，并且 机状态是从包含调试一个文件恢复。 调试 程序可以检查或通过读取或写入改变错误的程序的状态 被写为断点的结果的文件的部分。 调试器 以后恢复执行原始程序通过从恢复的机器状态 文件。 原来的程序和调试器这样的工作协同程序。 -检查点。 程序有时可能会节省磁盘文件的状态。 它然后可以 被打断，或者由处理器故障或由用户操作（例如，引导 机）。 计算可后来恢复机器状态恢复 从检查点文件。 -活动切换。 协程结构用于多个任务之间切换 是一个单一的应用程序的一部分。 一个例子是 打印服务器，该程序 接受文件从本地通信网络和打印它们。 该方案是 分成两个任务：一个 假脱机程序从网络中读取文件，并排队它们 磁盘文件，以及删除的条目从队列，并控制一台 打印机 硬件打印它们。 由于这些任务具有相当大的内部状态 和工作在不同的环境中，他们利用通信状态保存/恢复 机制。 每当后台打印程序空闲，但队列不为空，则它会将其状态 并调用打印机。 只要打印机完成或者检测到传入网络 交通，停止打印机硬件，保存其状态，并调用后台处理程序。 此 方案允许轻松打印中，以响应传入迅速中断 文件。 在许多系统中，状态恢复的机制将是极其危险的，因为他们可以 导致严重破坏的磁盘文件结构。 如果一个节目被保存时，这可能发生 它包含在部件盘的数据结构（例如，零件目录的存储器拷贝 或分配映射指示空闲块），并且它从不恢复，或未能更新 此信息反映实际的磁盘状态也恢复后。 标签检查 3.3节所述机械防止灾难性的破坏，如果信息 错误地更新。 此外，被保存和恢复提示通常仍然有效，并 可用于重新读取快速任何磁盘数据可能已被高速缓存在主存储器中。

一个开放的操作系统的单用户机 11 4.1 InLoad和OutLoad 两个程序，InLoad和OutLoad，是那些最常用的操作上 包含机器状态的磁盘文件。 每个例程需要作为参数一盘的全名 文件，并且需要大约一秒钟，以完成其操作： （ 写，消息 ）：= OutLoad（OutFN） InLoad（INFN，消息 ） OutLoad写在文件中的当前机器状态，并用书面标志返回 真实的。 注意，保存在输出文件中的程序计数器是内侧 OutLoad 程序本身。所述 InLoad程序恢复从给定的机器的状态文件，并传递 消息（约20万字），以恢复的计划。其效果是，OutLoad再次返回，这个时候写的假，并与那消息在所提供的 InLoad呼叫。对于联动协程这样的代码看起来像： 。 。 。 messageToPartner =参数传入呼叫协程;（ 写，messageFromPartner）：= OutLoad（myStateFN）;如果 写的 话 InLoad（partnerStateFN，messageToPartner）;messageFromPartner包含传递给我的参数; 。 。 。 如果在调用协程的参数将不适合在小消息向量，向量是 用于传递其中参数已被写在盘上的位置的全名。 常该消息包含一个 返回地址，也就是，以恢复在一个文件的全名返回。在上面的例子中，返回地址可以通过复制来提供 myStateFN成messageToPartner的前InLoad电话。该 InLoad和OutLoad程序，虽然很小（约900字），是但需经充分错误程序到闭塞。对于联动 调试器，这将是优选的，如果这些例程被保护的以某种方式。机 没有内存保护硬件或许应该落实读的程序 只读存储器（或在处理器微码不能被损坏）。我们塑造一个部分 解决这个问题的一个特殊的紧急引导程序，只含 OutLoad过程中，写入大多数机器状态到一个磁盘文件。不幸的是， 这种方法不能保留的一些最重要的状态（例如，处理器寄存器）。 5.组织公开制度 操作系统是常用子程序包是一个集合 通常存在于存储器的用户程序的便利性。该系统提供 流为磁盘文件，键盘输入和显示输出; 例程进行读写 直接磁盘页面; 在 OutLoad和InLoad程序; 一个免费的存储分配; BCPL运行程序; 并存储为一个很好的协议得心应手数据，诸如提示为frequently-的 用的文件，用户的姓名和密码等子程序包几乎写入 完全BCPL，一致约定存储分配和对象 调用。

一个开放的操作系统的单用户机 12 5.1调用程序 该系统包括在该执行程序调用程序BCPL 操作系统。该程序代码被从磁盘流中读取并加载到低 内存地址。操作系统程序的所有引用绑定，使用的是修正 表中包含的代码的文件。最后，程序通过调用一个条目调用 例程。该程序可以通过调用程序加载器来读取或者终止 另一方案，从而覆盖所述第一程序，或通过从主回 流程。如果程序返回，系统加载和运行的标准 执行 节目。执行接受用户的命令，从键盘并执行它们， 常常通过调用装载程序来调用程序的用户已经请求。 该操作系统下运行的程序，也可以从一个完全调用 不同的编程环境。该 InLoad程序对文件的调用包含操作系统的状态，这会导致系统中加载和初始化。 传递到消息向量 InLoad可包含含有一个文件的名称被调用程序。甲流打开此文件，并在程序加载和运行。 5.2润田 构成操作系统的包被组织来支持它的开放性。 一 程序，宁愿不使用由该系统提供的标准程序，或 需要使用由它们所占据的存储空间，可以要求一些或所有的系统 程序被从内存中删除。去除过程的过程称为 军政府，因为它强行接管机。当一个程序终止，一CounterJunta过程被称为恢复从标准程序InLoad / OutLoad上下文操作系统。该系统被组织成几个层次的服务，以使得程序可以选择 程序时，它希望保留。程序被布置为使得最低水平，这 包含最常用的服务，是在存储器中的最顶端。少无处不在 服务是数字越大级别，位于内存中低。最高级别 要保留数作为参数传递给 军政府，其中删除所有higher-编号级别并释放它们占用的存储空间。该 CounterJunta程序恢复各级卸下的，并重新初始化它们包含任何数据结构。 在每个级别中的设施总结如下： 1。 OutLoad / InLoad，CounterJunta 2。 键盘输入缓冲区。 3。 提示重要文件。 4。 BCPL运行程序（例如，堆栈帧分配）。 5,6。 磁盘（代码和数据的标准的磁盘的磁盘对象）。 7。 区（代码为标准的自由存储对象）。 8。 磁盘流（代码标准磁盘流对象）。 9。 磁盘目录。 10。 键盘流（代码标准键盘流对象）。 11。 显示流（代码标准显示流对象）。

一个开放的操作系统的单用户机 13 12。 程序加载器和军政府的过程。 13。 系统的免费存储空间，包括空间，默认显示流，磁盘流等 键盘输入缓冲器存在几乎总是，使得任何字符键入前方第 运行一个程序，当用户保存解释由下一个， 在 军政府和CounterJunta程序给程序员简单而精确的控制超过保留在存储器中的操作系统的设施。不像更复杂 机制，如交换代码段，该方案保证了性能 驻地系统。 有程序和用户的数据以及那些系统之间没有区别。 存储分配，例如，将建立区域内的对象分配的任何部分内存， 无论是在系统空闲存储区或没有。创建一个磁盘数据流的程序 对象需要另外两个对象作为参数：一个区域来分配空间流 数据结构（默认为系统自由存储区），以及用于调用磁盘对象 磁盘传输（默认为“标准盘”）。这是常见的使用大的程序 非标盘包括为特殊仅实现磁盘对象包 磁盘硬件，并使用标准的操作系统磁盘打开流上的文件 流的实现。 程序员期望更大的灵活性，鼓励以除去大部分系统的 与 军政府并纳入的标准包拷贝在自己的程序，放置无论他想要的。一个常见的​​原因的做法是稀缺的内存空间 迫使程序员覆盖的程序结构。例如，一个文件服务器程序 使用仅但非标准大硬盘采用标准的数据流盘 包，组织覆盖。显示器，键盘，和存储分配包 已组装以形成一个操作系统使用时不须一盘，用于支持 诊断或依赖于网络通信，而不是其他程序 本地磁盘存储。 操作系统作为子程序包的集合的成功取决于 主要在包装的设计。保留在内存中常见的简单程序 通过减少许多程序的大小，节省磁盘空间。保留通用数据 结构在内存中保存的初始化时间。在 军政府的过程是一个方便的，但不是必须的。它是专门讨论炼子程序相当大的努力 包，使他们既实用作为一个有凝聚力的操作系统，并作为独立的 包。像任何语言的设计，这是一个不平凡的事业，其难度 通过结果的明显的简单掩盖， 6.结论 我们已经描述了的一个小的操作系统的三个主要部分的设计。在每个 遇到相当大的麻烦已经采取了让所有的设施访问用户，在 意义上，它们可以从系统中的原语建立他们自己的宏操作 如果这些系统提供的证明不能令人满意。在文件处理我们 强调用于减少该数据将被破坏的概率方法。 和 允许崩溃后完全自动恢复。该方案的通讯设施

一个开放的操作系统的单用户机 14 强调接管整个机器程序之间的通讯合理 并组织以不同的方式。该组织成水平容纳方案 不走这么远，但仍需要大量的自己的命运控制; 它弥补了系统允许独立的包在这里适当的设计 操作是至关重要的。 采取使文件系统健壮的措施，其中，所述标签检测是至关重要的， 已经工作非常出色。成千上万的文件系统当前存在，运行 数百台机器没有任何集中维护。投诉的发生率 关于丢失的信息可以忽略不计。提示方案也做出了很好的工作 可能获得从系统高性能。由于不充分的解释 正确使用的提示，但是，许多程序员不明白到底是什么 是一个暗示，什么是绝对的，还是如何从一个淡淡的故障恢复正常。 作为一个 因此，它是较常见的比它应该是一个程序崩溃的消息“提示 失败，请重新安装“，而不是自动调用适当的恢复过程。 该系统的开放性也获得了成功，并已培养了大量 协同工作的相当融洽不同的编程环境号。 缅甸军政府已频繁用于去除标准处理程序人工输入/输出 该模拟电传终端，使实验程序可以控制的交互 很仔细，或以新颖的方式。 开放性的缺点是什么人会期​​望。因为这是不可能 虚拟化的系统，也没有实用的方法来改变表示或 文件系统或通信的功能。此外，也没有办法 拦截所有访问的文件系统，显示，或任何并将它们发送至其它一些 装置，例如一个远程文件系统。这可以仅通过改变机器的工作要做 微码。 致谢 许多上述的设施首先通过基因丹尼尔实现。 该 目前的实现是由作者完成，并一直由大卫改进 博格斯。原实现 InLoad / OutLoad和清除剂是由于吉姆·莫里斯。 参考 1.本苏桑，A。，等人，“在Multics的虚拟内存，” 通信。ACM 15，5（1972年5月）。2.博布罗，DG等人，“Tenex公司，一个分页分时系统为PDP-10，” 通信。ACM 15，3（1972年3月）。 3.博布罗，DG和B Wegbreit“的典范和堆栈实现多种环境，”通信。ACM 16，10（1973年10月）。4. BRINCH汉森，体育，操作系统原理，普伦蒂斯霍尔，1973年，纽约。5. Corbato，FJ等，“介绍和系统的Multics，概述” PROC。AFIPS CONF。 27 （1965年FJCC）。 6.达尔，OJ。和CAR Hoare的，“层次的程序结构”，在 结构化程序设计， 学术出版社，纽约，1972年。

